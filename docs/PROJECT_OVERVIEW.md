# 📋 项目总览

## 🎯 项目简介

这是一个基于 **Vue 3 + Supabase** 构建的商业级 SaaS 文件管理系统。支持用户注册、登录、文件上传、管理和预览等核心功能。

### 核心特性

- ✅ 用户认证系统（注册/登录/登出）
- ✅ 文件上传（支持拖拽）
- ✅ 图片管理
- ✅ Markdown 文件管理
- ✅ Markdown 在线预览（美化渲染）
- ✅ 文件下载（签名 URL）
- ✅ 文件删除
- ✅ 行级安全策略（RLS）
- ✅ 私有 Storage（加密访问）
- ✅ 响应式设计
- ✅ 商业级代码结构

## 🏗️ 技术架构

### 前端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| Vue 3 | ^3.3.11 | 渐进式 JavaScript 框架 |
| Vue Router | ^4.2.5 | 官方路由管理器 |
| Pinia | ^2.1.7 | 状态管理 |
| Vite | ^5.0.8 | 下一代前端构建工具 |
| Axios | ^1.6.2 | HTTP 客户端 |
| Markdown-it | ^14.0.0 | Markdown 渲染器 |

### 后端技术栈

| 技术 | 用途 |
|------|------|
| Supabase | 后端即服务（BaaS）平台 |
| PostgreSQL | 关系型数据库 |
| Supabase Auth | 用户认证系统 |
| Supabase Storage | 文件存储服务 |
| Row Level Security | 数据安全策略 |

## 📊 系统架构图

```
┌─────────────────────────────────────────────────────────┐
│                      用户浏览器                          │
│  ┌──────────────────────────────────────────────────┐  │
│  │              Vue 3 前端应用                       │  │
│  │  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐ │  │
│  │  │ 登录页 │  │ 主页面 │  │ 上传页 │  │ 预览页 │ │  │
│  │  └────────┘  └────────┘  └────────┘  └────────┘ │  │
│  │                                                   │  │
│  │  ┌────────────────────────────────────────────┐ │  │
│  │  │         Vue Router（路由管理）             │ │  │
│  │  └────────────────────────────────────────────┘ │  │
│  │                                                   │  │
│  │  ┌────────────────────────────────────────────┐ │  │
│  │  │         Pinia（状态管理）                  │ │  │
│  │  └────────────────────────────────────────────┘ │  │
│  │                                                   │  │
│  │  ┌────────────────────────────────────────────┐ │  │
│  │  │         API 层（Supabase Client）          │ │  │
│  │  └────────────────────────────────────────────┘ │  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
                          │
                          │ HTTPS
                          ▼
┌─────────────────────────────────────────────────────────┐
│                    Supabase 后端                         │
│  ┌──────────────────────────────────────────────────┐  │
│  │              Supabase Auth                        │  │
│  │         （用户认证和会话管理）                     │  │
│  └──────────────────────────────────────────────────┘  │
│                                                          │
│  ┌──────────────────────────────────────────────────┐  │
│  │            PostgreSQL 数据库                      │  │
│  │  ┌────────────────────────────────────────────┐  │  │
│  │  │  files 表（文件元数据）                    │  │  │
│  │  │  - id, user_id, path, name, type, size    │  │  │
│  │  └────────────────────────────────────────────┘  │  │
│  │  ┌────────────────────────────────────────────┐  │  │
│  │  │  RLS 策略（行级安全）                      │  │  │
│  │  │  - 用户只能访问自己的数据                  │  │  │
│  │  └────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────┘  │
│                                                          │
│  ┌──────────────────────────────────────────────────┐  │
│  │           Supabase Storage                        │  │
│  │  ┌────────────────────────────────────────────┐  │  │
│  │  │  private-files bucket（私有存储桶）        │  │  │
│  │  │  - images/                                 │  │  │
│  │  │  - markdown/                               │  │  │
│  │  └────────────────────────────────────────────┘  │  │
│  │  ┌────────────────────────────────────────────┐  │  │
│  │  │  Storage 策略                              │  │  │
│  │  │  - 用户只能访问自己的文件                  │  │  │
│  │  └────────────────────────────────────────────┘  │  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
```

## 🔐 安全架构

### 多层安全防护

1. **认证层**
   - Supabase Auth 提供 JWT 令牌
   - 会话管理和刷新
   - 密码加密存储

2. **授权层**
   - Row Level Security（RLS）
   - 用户只能访问自己的数据
   - 数据库级别的权限控制

3. **存储层**
   - 私有 Storage bucket
   - 签名 URL 访问
   - 文件路径包含用户 ID

4. **应用层**
   - 路由守卫
   - 前端验证
   - 错误处理

### 数据流安全

```
用户操作 → 前端验证 → API 调用 → JWT 验证 → RLS 检查 → 数据库操作
```

## 📁 文件结构

```
project-root/
├── frontend/                      # 前端项目
│   ├── src/
│   │   ├── api/                  # API 接口层
│   │   │   ├── supabase.js       # Supabase 客户端
│   │   │   ├── auth.js           # 认证 API
│   │   │   └── files.js          # 文件 API
│   │   ├── components/           # Vue 组件
│   │   │   ├── FileUploader.vue  # 上传组件
│   │   │   ├── FileList.vue      # 列表组件
│   │   │   └── MarkdownViewer.vue # 预览组件
│   │   ├── pages/                # 页面组件
│   │   │   ├── Login.vue         # 登录页
│   │   │   ├── Dashboard.vue     # 主页
│   │   │   ├── Upload.vue        # 上传页
│   │   │   └── Preview.vue       # 预览页
│   │   ├── router/               # 路由配置
│   │   │   └── index.js
│   │   ├── stores/               # 状态管理
│   │   │   └── user.js
│   │   ├── utils/                # 工具函数
│   │   │   ├── helpers.js
│   │   │   └── markdown.js
│   │   ├── App.vue               # 根组件
│   │   ├── main.js               # 入口文件
│   │   └── style.css             # 全局样式
│   ├── index.html
│   ├── vite.config.js
│   ├── package.json
│   ├── .env                      # 环境变量
│   ├── .env.example
│   └── .gitignore
│
├── backend/                       # 后端配置
│   ├── sql/                      # 数据库脚本
│   │   ├── 01_tables.sql         # 表结构
│   │   ├── 02_rls.sql            # 安全策略
│   │   └── 03_seed.sql           # 种子数据
│   ├── storage-rules/            # Storage 配置
│   │   └── private-files.json
│   └── README.md
│
├── README.md                      # 项目说明
├── QUICKSTART.md                  # 快速启动
├── DEVELOPMENT.md                 # 开发指南
├── DEPLOYMENT.md                  # 部署指南
├── PROJECT_OVERVIEW.md            # 项目总览（本文件）
└── .gitignore
```

## 🔄 核心业务流程

### 1. 用户注册流程

```
用户输入邮箱密码 
  → 前端验证 
  → 调用 Supabase Auth API 
  → 创建用户账户 
  → （可选）发送验证邮件 
  → 返回用户信息
```

### 2. 用户登录流程

```
用户输入邮箱密码 
  → 前端验证 
  → 调用 Supabase Auth API 
  → 验证凭据 
  → 生成 JWT 令牌 
  → 保存到 Pinia Store 
  → 跳转到主页
```

### 3. 文件上传流程

```
选择文件 
  → 前端验证（大小、类型） 
  → 生成文件路径（type/userId/timestamp-filename） 
  → 上传到 Supabase Storage 
  → 记录元数据到数据库 
  → 刷新文件列表
```

### 4. 文件访问流程

```
点击下载/预览 
  → 获取文件信息 
  → 生成签名 URL（有效期 1 小时） 
  → 访问文件 
  → 下载或渲染显示
```

### 5. Markdown 预览流程

```
点击预览按钮 
  → 获取文件信息 
  → 生成签名 URL 
  → 下载文件内容 
  → Markdown-it 渲染 
  → 显示美化后的 HTML
```

## 📊 数据库设计

### files 表

| 字段 | 类型 | 说明 |
|------|------|------|
| id | uuid | 主键，自动生成 |
| user_id | uuid | 用户 ID，外键关联 auth.users |
| path | text | 文件在 Storage 中的路径 |
| name | text | 文件名 |
| type | text | 文件类型（images/markdown） |
| size | int | 文件大小（字节） |
| created_at | timestamp | 创建时间 |

### 索引

- `idx_files_user_id` - 用户 ID 索引（提升查询性能）
- `idx_files_created_at` - 创建时间索引（排序优化）

## 🎨 UI/UX 设计

### 设计原则

1. **简洁明了** - 界面清晰，操作直观
2. **响应式** - 适配各种屏幕尺寸
3. **一致性** - 统一的视觉风格
4. **反馈及时** - 操作有明确的反馈
5. **容错性** - 友好的错误提示

### 颜色系统

- **主色调**：蓝色（#4299e1）- 专业、可信赖
- **成功色**：绿色（#48bb78）- 积极、完成
- **警告色**：橙色（#ed8936）- 注意、提醒
- **错误色**：红色（#e53e3e）- 错误、危险
- **中性色**：灰色系 - 文本、背景

### 交互设计

- **拖拽上传** - 提升用户体验
- **加载状态** - 明确的加载指示
- **确认对话框** - 重要操作需要确认
- **即时反馈** - 操作结果立即显示

## 📈 性能指标

### 目标性能

- **首屏加载** < 2 秒
- **文件上传** < 5 秒（10MB 文件）
- **页面切换** < 500ms
- **Markdown 渲染** < 1 秒

### 优化策略

1. **代码分割** - 路由懒加载
2. **资源压缩** - Gzip/Brotli
3. **缓存策略** - 浏览器缓存
4. **CDN 加速** - 静态资源 CDN
5. **数据库索引** - 查询优化

## 🔧 开发工具链

### 必需工具

- Node.js 18+
- npm/yarn
- Git
- 代码编辑器（VS Code 推荐）

### 推荐扩展

- Vue Language Features (Volar)
- ESLint
- Prettier
- GitLens

## 📚 文档导航

- **[README.md](./README.md)** - 项目介绍和功能说明
- **[QUICKSTART.md](./QUICKSTART.md)** - 5 分钟快速启动
- **[DEVELOPMENT.md](./DEVELOPMENT.md)** - 详细开发指南
- **[DEPLOYMENT.md](./DEPLOYMENT.md)** - 生产环境部署
- **[backend/README.md](./backend/README.md)** - 后端配置说明

## 🎯 未来规划

### 短期计划（1-3 个月）

- [ ] 添加文件搜索功能
- [ ] 支持文件夹组织
- [ ] 添加文件分享功能
- [ ] 支持更多文件类型
- [ ] 添加文件预览（PDF、视频等）

### 中期计划（3-6 个月）

- [ ] 团队协作功能
- [ ] 文件版本控制
- [ ] 在线编辑 Markdown
- [ ] 文件评论功能
- [ ] 移动端 App

### 长期计划（6-12 个月）

- [ ] AI 智能分类
- [ ] 文件内容搜索
- [ ] 高级权限管理
- [ ] 企业级功能
- [ ] API 开放平台

## 📊 项目统计

- **代码行数**: ~2000+ 行
- **组件数量**: 7 个
- **API 接口**: 8 个
- **页面数量**: 4 个
- **开发周期**: 2-3 天
- **维护难度**: 低

## 🤝 贡献者

欢迎贡献代码！请查看 [DEVELOPMENT.md](./DEVELOPMENT.md) 了解如何参与开发。

## 📄 许可证

MIT License - 可自由使用、修改和分发

## 📞 支持

- 📧 Email: support@example.com
- 💬 Issue: [GitHub Issues](https://github.com/your-repo/issues)
- 📖 文档: [项目文档](./README.md)

---

**最后更新**: 2024-01-01
**版本**: 1.0.0
**状态**: ✅ 生产就绪
