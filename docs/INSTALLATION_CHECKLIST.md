# ✅ 安装验证清单

使用此清单确保项目正确安装和配置。

## 📋 安装前检查

### 环境要求
- [ ] Node.js 18+ 已安装
- [ ] npm 或 yarn 已安装
- [ ] Git 已安装
- [ ] 有 Supabase 账户
- [ ] 浏览器（Chrome/Firefox/Safari）

验证命令：
```bash
node --version    # 应该 >= 18.0.0
npm --version     # 应该 >= 9.0.0
git --version     # 任意版本
```

## 🔧 Supabase 配置检查

### 1. 项目创建
- [ ] 已在 supabase.com 创建新项目
- [ ] 项目状态显示为 "Active"
- [ ] 已记录 Project URL
- [ ] 已记录 anon public key

### 2. 数据库配置
- [ ] 已执行 `backend/sql/01_tables.sql`
- [ ] 已执行 `backend/sql/02_rls.sql`
- [ ] 在 SQL Editor 中无错误提示

验证方法：
```sql
-- 在 Supabase SQL Editor 中运行
SELECT * FROM files LIMIT 1;
-- 应该返回空结果（无错误）
```

### 3. Storage 配置
- [ ] 已创建 `private-files` bucket
- [ ] Bucket 设置为私有（Public = false）
- [ ] 已添加 3 个 Storage 策略：
  - [ ] Users can upload own files
  - [ ] Users can view own files
  - [ ] Users can delete own files

验证方法：
- 在 Storage → private-files → Policies 中应该看到 3 个策略

### 4. 认证配置
- [ ] Email 认证已启用
- [ ] （可选）邮箱验证已配置
- [ ] （可选）密码策略已设置

## 💻 前端配置检查

### 1. 依赖安装
```bash
cd frontend
npm install
```

检查：
- [ ] 安装过程无错误
- [ ] `node_modules` 目录已创建
- [ ] 所有依赖都已安装

### 2. 环境变量配置
- [ ] 已创建 `.env` 文件
- [ ] `VITE_SUPABASE_URL` 已填写
- [ ] `VITE_SUPABASE_ANON_KEY` 已填写
- [ ] URL 格式正确（https://xxx.supabase.co）
- [ ] Key 格式正确（长字符串）

验证 `.env` 文件：
```env
VITE_SUPABASE_URL=https://xxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

### 3. 启动开发服务器
```bash
npm run dev
```

检查：
- [ ] 服务器启动成功
- [ ] 浏览器自动打开
- [ ] 访问 http://localhost:3000
- [ ] 页面正常显示
- [ ] 控制台无错误

## 🧪 功能测试检查

### 1. 注册功能测试
- [ ] 访问注册页面
- [ ] 输入邮箱和密码
- [ ] 点击注册按钮
- [ ] 注册成功（或收到验证邮件）
- [ ] 无错误提示

测试账户建议：
- 邮箱：test@example.com
- 密码：test123456

### 2. 登录功能测试
- [ ] 输入注册的邮箱密码
- [ ] 点击登录按钮
- [ ] 成功跳转到主页
- [ ] 显示"我的文件"页面
- [ ] 右上角显示"上传文件"和"退出登录"按钮

### 3. 上传功能测试

#### 测试图片上传
- [ ] 点击"上传文件"按钮
- [ ] 选择一张图片（jpg/png）
- [ ] 文件预览显示正确
- [ ] 点击"上传文件"
- [ ] 显示"上传成功"提示
- [ ] 自动返回主页
- [ ] 文件列表中显示上传的图片

#### 测试 Markdown 上传
- [ ] 创建一个测试 .md 文件
- [ ] 上传该文件
- [ ] 上传成功
- [ ] 文件列表中显示 📝 图标

测试 Markdown 文件内容：
```markdown
# 测试标题

这是一个测试文件。

## 功能列表

- 功能 1
- 功能 2
- 功能 3

**粗体文本** 和 *斜体文本*
```

#### 测试拖拽上传
- [ ] 拖拽文件到上传区域
- [ ] 区域高亮显示
- [ ] 释放文件
- [ ] 文件被选中
- [ ] 上传成功

### 4. 文件管理测试
- [ ] 文件列表正确显示
- [ ] 显示文件名、大小、时间
- [ ] 文件图标正确（🖼️ 或 📝）
- [ ] 时间格式友好（"刚刚"、"5分钟前"等）

### 5. 下载功能测试
- [ ] 点击文件的下载按钮（⬇️）
- [ ] 新标签页打开
- [ ] 文件正确下载或显示
- [ ] 文件内容完整

### 6. Markdown 预览测试
- [ ] 点击 Markdown 文件的预览按钮（👁️）
- [ ] 跳转到预览页面
- [ ] Markdown 正确渲染
- [ ] 样式美观
- [ ] 标题、列表、粗体等格式正确
- [ ] 点击"返回"按钮正常

### 7. 删除功能测试
- [ ] 点击文件的删除按钮（🗑️）
- [ ] 显示确认对话框
- [ ] 点击"确定"
- [ ] 文件从列表中消失
- [ ] 刷新页面后文件仍然不存在

### 8. 登出功能测试
- [ ] 点击"退出登录"按钮
- [ ] 显示确认对话框
- [ ] 点击"确定"
- [ ] 跳转到登录页
- [ ] 无法访问主页（自动跳转到登录页）

## 🔒 安全性验证

### 1. 数据隔离测试
- [ ] 创建两个测试账户
- [ ] 账户 A 上传文件
- [ ] 登出账户 A
- [ ] 登录账户 B
- [ ] 账户 B 看不到账户 A 的文件 ✅

### 2. 路由保护测试
- [ ] 登出状态
- [ ] 尝试访问 http://localhost:3000/
- [ ] 自动跳转到 /login ✅
- [ ] 尝试访问 http://localhost:3000/upload
- [ ] 自动跳转到 /login ✅

### 3. 文件访问测试
- [ ] 上传文件后获取 URL
- [ ] 登出
- [ ] 尝试直接访问该 URL
- [ ] 应该无法访问（签名过期或无权限）✅

## 📱 响应式测试

### 桌面端（1920x1080）
- [ ] 布局正常
- [ ] 所有功能可用
- [ ] 样式美观

### 平板端（768x1024）
- [ ] 布局自适应
- [ ] 按钮大小合适
- [ ] 文字可读

### 移动端（375x667）
- [ ] 布局正常
- [ ] 可以正常操作
- [ ] 上传功能可用

测试方法：
- 使用浏览器开发者工具
- 切换不同设备尺寸
- 或使用真实设备测试

## 🐛 错误处理测试

### 1. 网络错误
- [ ] 断开网络
- [ ] 尝试上传文件
- [ ] 显示友好的错误提示
- [ ] 恢复网络后可以继续使用

### 2. 文件大小限制
- [ ] 尝试上传超过 50MB 的文件
- [ ] 显示"文件太大"错误
- [ ] 不会上传

### 3. 文件类型限制
- [ ] 尝试上传不支持的文件类型（如 .exe）
- [ ] 显示"不支持的文件类型"错误
- [ ] 不会上传

### 4. 登录错误
- [ ] 输入错误的密码
- [ ] 显示错误提示
- [ ] 可以重新尝试

## 🚀 性能检查

### 加载性能
- [ ] 首屏加载 < 3 秒
- [ ] 页面切换流畅
- [ ] 无明显卡顿

### 上传性能
- [ ] 小文件（< 1MB）上传 < 2 秒
- [ ] 中等文件（1-10MB）上传 < 10 秒
- [ ] 大文件（10-50MB）上传 < 30 秒

### 浏览器控制台
- [ ] 无 JavaScript 错误
- [ ] 无 404 错误
- [ ] 无警告信息（或仅有可忽略的警告）

## 📊 最终验证

### 代码检查
- [ ] 所有文件都已创建
- [ ] 没有语法错误
- [ ] 代码格式规范

### 文档检查
- [ ] README.md 存在且完整
- [ ] QUICKSTART.md 存在
- [ ] DEVELOPMENT.md 存在
- [ ] DEPLOYMENT.md 存在
- [ ] 所有文档链接有效

### Git 检查
- [ ] .gitignore 配置正确
- [ ] .env 文件未被提交
- [ ] node_modules 未被提交

## ✅ 完成标准

当以上所有项目都打勾时，说明：

🎉 **项目安装成功！**
🎉 **所有功能正常！**
🎉 **可以开始使用了！**

## 🆘 常见问题排查

### 问题 1：npm install 失败
**解决方案：**
```bash
# 清除缓存
npm cache clean --force

# 删除 node_modules
rm -rf node_modules package-lock.json

# 重新安装
npm install
```

### 问题 2：无法连接 Supabase
**检查：**
1. .env 文件中的 URL 和 Key 是否正确
2. Supabase 项目是否正常运行
3. 网络连接是否正常
4. 浏览器控制台的错误信息

### 问题 3：上传失败
**检查：**
1. Storage bucket 是否创建
2. Storage 策略是否配置
3. 文件大小是否超限
4. 文件类型是否支持

### 问题 4：RLS 错误
**解决方案：**
```sql
-- 在 Supabase SQL Editor 中重新执行
-- backend/sql/02_rls.sql 的内容
```

### 问题 5：页面空白
**检查：**
1. 浏览器控制台错误
2. 网络请求是否成功
3. .env 配置是否正确
4. 尝试清除浏览器缓存

## 📞 获取帮助

如果遇到问题：

1. 查看浏览器控制台错误
2. 查看 Supabase Dashboard 日志
3. 参考项目文档
4. 搜索相关错误信息
5. 提交 Issue

## 🎓 下一步

安装验证完成后：

1. 阅读 [DEVELOPMENT.md](./DEVELOPMENT.md) 学习开发
2. 阅读 [DEPLOYMENT.md](./DEPLOYMENT.md) 了解部署
3. 开始自定义和扩展功能
4. 享受开发过程！

---

**祝你使用愉快！** 🚀
